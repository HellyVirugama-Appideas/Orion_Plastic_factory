<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<head>
  <%- include('_layouts/head') %>
  <title>Dashboard | <%= title %></title>
  <link rel="stylesheet" type="text/css" href="/app-assets/css/pages/dashboard.css">
</head>

<body class="vertical-layout page-header-light vertical-menu-collapsible vertical-dark-menu preload-transitions 2-columns"
      data-open="click" data-menu="vertical-dark-menu" data-col="2-columns">

 <%- include('_layouts/sidenavbar') %>

  <div id="main">
    <div class="row dashboard">
      <div class="col s12">
        <div class="container">
          <div class="section">
            <div id="card-stats" class="pt-0">
              <div class="row">
                <%- include('messages', { messages: messages }) %>
              </div>

              <div class="row mt-2">

                <!-- Total Orders Card -->
                <div class="col m3 s12" style="padding: 10px;">
                  <a href="/admin/orders" style="text-decoration: none;">
                    <div style="background-color: #1A9CFF; border-radius: 20px; padding: 10px 10px 20px 30px;">
                      <h4 style="font-size: 40px; color: #FFFFFF; font-weight: 900;" class="counter"
                          data-target="<%= stats.totalOrders || 0 %>">
                        0
                      </h4>
                      <span style="font-size: 22px; color: #FFFFFF;">Total Orders</span>
                    </div>
                  </a>
                </div>

                <!-- Total Drivers Card -->
                <div class="col m3 s12" style="padding: 10px;">
                  <a href="/admin/drivers" style="text-decoration: none;">
                    <div style="background-color: #5139DB; border-radius: 20px; padding: 10px 10px 20px 30px;">
                      <h4 style="font-size: 40px; color: #FFFFFF; font-weight: 900;" class="counter"
                          data-target="<%= stats.totalDrivers || 0 %>">
                        0
                      </h4>
                      <span style="font-size: 22px; color: #FFFFFF;">Total Drivers</span>
                    </div>
                  </a>
                </div>

                <!-- Today's Revenue Card -->
                <div class="col m3 s12" style="padding: 10px;">
                  <a href="/admin/orders?status=delivered" style="text-decoration: none;">
                    <div style="background-color: #31B411; border-radius: 20px; padding: 10px 10px 20px 30px;">
                      <h4 style="font-size: 40px; color: #FFFFFF; font-weight: 900;" class="counter"
                          data-target="<%= stats.todayRevenue || 0 %>">
                        0
                      </h4>
                      <span style="font-size: 22px; color: #FFFFFF;">Today's Revenue (₹)</span>
                    </div>
                  </a>
                </div>

                <!-- Active Deliveries Card -->
                <div class="col m3 s12" style="padding: 10px;">
                  <a href="/admin/deliveries?status=in_transit,out_for_delivery" style="text-decoration: none;">
                    <div style="background-color: #FF531A; border-radius: 20px; padding: 10px 10px 20px 30px;">
                      <h4 style="font-size: 40px; color: #FFFFFF; font-weight: 900;" class="counter"
                          data-target="<%= stats.activeDeliveries || 0 %>">
                        0
                      </h4>
                      <span style="font-size: 22px; color: #FFFFFF;">Active Deliveries</span>
                    </div>
                  </a>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%- include('_layouts/commonJs') %>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const counters = document.querySelectorAll('.counter');

      counters.forEach(counter => {
        const target = +counter.getAttribute('data-target');
        let count = 0;
        const speed = 100; // animation speed

        const updateCounter = () => {
          const increment = target / speed;
          if (count < target) {
            count += increment;
            counter.textContent = Math.ceil(count).toLocaleString();
            setTimeout(updateCounter, 20);
          } else {
            counter.textContent = target.toLocaleString();
          }
        };

        // Intersection Observer – animation tab chale jab card visible ho
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              updateCounter();
              observer.unobserve(counter);
            }
          });
        }, { threshold: 0.5 });

        observer.observe(counter);
      });
    });
  </script>
</body>
</html>